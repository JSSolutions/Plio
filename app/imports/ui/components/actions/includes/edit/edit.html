<template name="Actions_Edit">
  <div>
    <div class="relative">
      {{#with action}}
        <div class="card-block">
          {{> Actions_Title title=this.title}}

          {{> Actions_LinkedTo_Edit
              _id=this._id
              linkedDocs=this.linkedDocuments
              isEditable=isLinkedToEditable}}

          {{> Actions_Status status=this.status}}

          {{> Actions_Owner ownerId=this.ownerId}}

          {{> Actions_PlanInPlace planInPlace=this.planInPlace}}

          <hr />

          {{> Actions_CompletionTargetDate
              completionTargetDate=this.completionTargetDate
              enabled=(isCompletionEditable this.isVerified)}}

          {{#unless isCompleted}}

            {{> Actions_ToBeCompletedBy
                toBeCompletedBy=this.toBeCompletedBy
                onComplete=completeFn}}

          {{else}}

            {{> Actions_CompletedOn
                completedAt=this.completedAt
                enabled=isCompletionEditable}}

            {{> Actions_CompletedBy
                completedBy=this.completedBy
                completedAt=this.completedAt
                enabled=isCompletionEditable
                onUndo=undoCompletionFn}}

            {{> Actions_CompletionResult
                completionResult=this.completionResult
                enabled=isCompletionEditable}}

            <hr />

            {{> Actions_VerificationTargetDate
                verificationTargetDate=this.verificationTargetDate}}

            {{#unless isVerified}}

              {{> Actions_ToBeVerifiedBy
                  toBeVerifiedBy=this.toBeVerifiedBy
                  onVerify=verifyFn}}

            {{else}}

              {{> Actions_VerifiedOn verifiedAt=verifiedAt}}

              {{> Actions_VerifiedBy
                  verifiedBy=this.verifiedBy
                  verifiedAt=this.verifiedAt
                  onUndo=undoVerificationFn}}

              {{> Actions_VerificationResult
                  verificationResult=this.verificationResult}}

            {{/unless}}

          {{/unless}}
        </div>

        {{> Subcards_Notify_Edit
            document=this
            documentType="action"
            onUpdate=onUpdateNotifyUserCb}}

        {{> Subcards_Notes_Edit
            notes=this.notes}}

        {{> Subcards_OtherFiles_Edit
            label="Files"
            _id=this._id
            files=this.files
            uploaderMetaContext=uploaderMetaContext
            slingshotDirective=slingshotDirective}}
      {{/with}}
    </div>
  </div>
</template>
